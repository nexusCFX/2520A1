C     FORTRAN PROGRAM TO PLAY GAME OF DICE USING MONTE CARLO METHODS
      PROGRAM CIRCLE
      DIMENSION N(2), NN(2), NO(2)
      NW=0
      NL=0
      READ 100,I,J,NTEST
  100 FORMAT(I5,I5,I10)
      L=947
      M=941
   25 DO 7 K=1,2
      I=I+I
      J=J+J
      IF(I-L)1,2,2
    2 I=I-L
    1 IF(J-M)3,4,4
    4 J=J-M
    3 N(K)=I+J
      IF (N(K)-1000)5,6,6
    6 N(K)=N(K)-1000
    5 NN(K)=N(K)/6
    7 NO(K)=N(K)-6*NN(K)+1
      NSUM=NO(1)+NO(2)
      IF(NSUM-7)9,8,9
    9 IF(NSUM-11)10,8,10
   10 IF(NSUM-2)12,11,12
   12 IF(NSUM-3)13,11,13
   13 IF(NSUM-12)14,11,14
   14 NPT=NSUM
      INDEX=0
   27 DO 15 K=1,2
      I=I+I
      J=J+J
      IF(I-L)16,17,17
   17 I=I-L
   16 IF(J-M)18,19,19
   19 J=J-M
   18 N(K)=I+J
      IF(N(K)-1000)20,21,21
   21 N(K)=N(K)-1000
   20 NN(K)=N(K)/6
   15 NO(K)=N(K)-6*NN(K)+1
      NSUM=NO(1)+NO(2)
      IF(NSUM-7)26,11,26
   26 IF(NSUM-NPT)22,8,22
   22 INDEX=INDEX+1
      IF(INDEX-100)27,27,28
    8 NW=NW+1
      GO TO 23
   11 NL=NL+1
   23 NTOT=NL+NW
      IF(NTOT-NTEST)25,24,24
   24 PRINT 200,NW,NL,I,J
  200 FORMAT(8H WINS = ,I5,11H   LOSSES =,I5,7H   I =  ,I4,6H  J = ,I4)
      STOP
   28 PRINT 300
  300 FORMAT(20H INDEX EXCEEDS LIMIT)
      GO TO 24
      END
